{{ 'jewlr-hero-banner.css' | asset_url | stylesheet_tag }}
{%- comment -%}
  {% comment %} <div
    id="{{ banner_id }}"
    class="{{ banner_classes }}"
    style="{{ background_style }}"
  >
    {%- if section.settings.background_type == 'image' -%}
      {%- if section.settings.background_image != blank -%}
        {%- assign image_class = 'hero-bg-image' -%}
        {%- if section.settings.background_image_mobile != blank -%}
          {%- assign image_class = image_class | append: ' hero-bg-image--desktop' -%}
        {%- endif -%}
        <div class="hero-bg-image-wrapper hero-bg-image-wrapper--desktop" style="position:relative;width:100%;overflow:hidden;">
          <style>
            #{{ banner_id }} .hero-bg-image-wrapper--desktop::before {
              content: '';
              display: block;
              padding-bottom: {{ 1 | divided_by: section.settings.background_image.aspect_ratio | times: 100 }}%;
            }
            #{{ banner_id }} .hero-bg-image {
              position: absolute;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              object-fit: cover;
              display: block;
            }
          </style>
          {{ section.settings.background_image | image_url: width: 3840 | image_tag:
            loading: 'lazy',
            width: section.settings.background_image.width,
            height: section.settings.background_image.height,
            class: image_class,
            sizes: '100vw',
            widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
          }}
        </div>
      {%- endif -%}
      {%- if section.settings.background_image_mobile != blank -%}
          <div class="hero-bg-image-wrapper hero-bg-image-wrapper--mobile" style="position:relative;width:100%;height:auto;aspect-ratio:750/892;max-width:100vw;overflow:hidden;">
            {{ section.settings.background_image_mobile | image_url: width: 1500 | image_tag:
              loading: 'lazy',
              width: 750,
              height: 892,
              class: 'hero-bg-image hero-bg-image--mobile',
              sizes: '100vw',
              widths: '375, 550, 750, 1100, 1500',
              style: 'width:100%;height:auto;object-fit:cover;display:block;'
            }}
          </div>
      {%- endif -%}
    {%- endif -%}

    {%- if section.settings.background_type == 'video' and section.settings.background_video != blank -%}{{ 'jewlr-hero-banner.css' | asset_url | stylesheet_tag }} {%- endcomment -%}
  {{ 'jewlr-hero-banner.css' | asset_url | stylesheet_tag }}
{%- endcomment -%}

{%- liquid
  assign banner_id = 'Banner-' | append: section.id
  assign banner_classes = 'jewlr-hero-banner section-' | append: section.id | append: '-padding'

  if section.settings.show_content_background
    assign banner_classes = banner_classes | append: ' jewlr-hero-banner--show-content-bg'
  endif

  assign background_style = ''
  if section.settings.background_type == 'gradient' and section.settings.background_gradient != blank
    assign background_style = 'background: ' | append: section.settings.background_gradient | append: ';'
  endif
-%}

<div
  id="{{ banner_id }}"
  class="{{ banner_classes }}"
  style="{{ background_style }} height: {{ section.settings.height_desktop }}px;"
>
  <div class="jewlr-hero-banner__media">
    {%- case section.settings.background_type -%}
      {%- when 'image' -%}
        {%- if section.settings.background_image_mobile != blank -%}
          {{
            section.settings.background_image_mobile
            | image_url: width: 750
            | image_tag:
              loading: 'lazy',
              class: 'jewlr-hero-banner__image jewlr-hero-banner__image--mobile',
              widths: '375, 550, 750',
              sizes: '100vw'
          }}
        {%- endif -%}

        {%- if section.settings.background_image != blank -%}
          {{
            section.settings.background_image
            | image_url: width: 3840
            | image_tag:
              loading: 'lazy',
              class: 'jewlr-hero-banner__image jewlr-hero-banner__image--desktop',
              widths: '750, 1100, 1500, 1780, 2000, 3000, 3840',
              sizes: '100vw'
          }}
        {%- endif -%}
      {%- when 'video' -%}
        <div class="jewlr-hero-banner__video-wrapper">
          {%- if section.settings.background_video != blank -%}
            {%- if section.settings.background_video contains 'youtube.com'
              or section.settings.background_video contains 'youtu.be'
            -%}
              {%- assign video_id = '' -%}
              {%- if section.settings.background_video contains 'youtube.com/watch' -%}
                {%- assign video_id = section.settings.background_video | split: 'v=' | last | split: '&' | first -%}
              {%- elsif section.settings.background_video contains 'youtu.be/' -%}
                {%- assign video_id = section.settings.background_video | split: '.be/' | last -%}
              {%- endif -%}
              <iframe
                src="https://www.youtube.com/embed/{{ video_id }}?enablejsapi=1&autoplay=1&loop=1&playlist={{ video_id }}&controls=0&mute=1"
                class="jewlr-hero-banner__video"
                allow="autoplay; encrypted-media"
                allowfullscreen
              ></iframe>
            {%- elsif section.settings.background_video contains 'vimeo.com' -%}
              {%- assign video_id = section.settings.background_video | split: '.com/' | last | split: '/' | first -%}
              <iframe
                src="https://player.vimeo.com/video/{{ video_id }}?autoplay=1&loop=1&background=1"
                class="jewlr-hero-banner__video"
                allow="autoplay; encrypted-media"
                allowfullscreen
              ></iframe>
            {%- else -%}
              <video class="jewlr-hero-banner__video" autoplay loop muted playsinline>
                <source src="{{ section.settings.background_video }}" type="video/mp4">
              </video>
            {%- endif -%}
          {%- endif -%}
        </div>
    {%- endcase -%}
  </div>
  <div class="hero-container">
    <div class="hero-content">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'heading' %}
            <style>
              .hero-heading-{{ block.id }} {
                font-size: {{ block.settings.font_size }}px;
                margin-bottom: {{ block.settings.margin_bottom }}px;
                font-weight: {{ block.settings.font_weight }};
                color: {{ block.settings.color }};
              }
              @media (max-width: 749px) {
                .hero-heading-{{ block.id }} {
                  font-size: {{ block.settings.font_size_mobile }}px;
                  margin-bottom: {{ block.settings.margin_bottom_mobile }}px;
                  {% unless block.settings.show_on_mobile %}display: none;{% endunless %}
                }
              }
            </style>
            {% if block.settings.tag == 'h1' %}
              <h1 class="hero-heading hero-heading-{{ block.id }}">
                {{ block.settings.text }}
              </h1>
            {% elsif block.settings.tag == 'h2' %}
              <h2 class="hero-heading hero-heading-{{ block.id }}">
                {{ block.settings.text }}
              </h2>
            {% elsif block.settings.tag == 'h3' %}
              <h3 class="hero-heading hero-heading-{{ block.id }}">
                {{ block.settings.text }}
              </h3>
            {% endif %}
          {% when 'subheading' %}
            <style>
              .hero-subheading-row-{{ block.id }} {
                margin-bottom: {{ block.settings.margin_bottom }}px;
                justify-content: flex-start;
              }
              .hero-subheading-{{ block.id }} {
                font-size: {{ block.settings.font_size }}px;
                font-weight: {{ block.settings.font_weight }};
                color: {{ block.settings.color }};
              }
              @media (max-width: 749px) {
                .hero-subheading-row-{{ block.id }} {
                  margin-bottom: {{ block.settings.margin_bottom_mobile }}px;
                  justify-content: center;
                  {% unless block.settings.show_on_mobile %}display: none !important;{% endunless %}
                }
                .hero-subheading-{{ block.id }} {
                  font-size: {{ block.settings.font_size_mobile }}px;
                }
              }
            </style>
            <div
              class="hero-subheading-row hero-subheading-row-{{ block.id }}"
              style="display:flex;flex-direction:row;align-items:center;gap:{{ block.settings.icon_gap | default: 8 }}px;"
            >
              {% if block.settings.icon != blank %}
                {% if block.settings.icon_placement == 'left' or block.settings.icon_placement == blank %}
                  <span class="hero-icon" style="display:inline-block;vertical-align:middle;">
                    <img
                      src="{{ block.settings.icon | image_url: width: 120 }}"
                      alt=""
                      width="120"
                      height="71"
                      style="width:120px;height:70px;object-fit:contain;display:block;"
                    >
                  </span>
                {% endif %}
              {% endif %}
              <p class="hero-subheading hero-subheading-{{ block.id }}">
                {{ block.settings.text }}
              </p>
              {% if block.settings.icon != blank %}
                {% if block.settings.icon_placement == 'right' %}
                  <span class="hero-icon" style="display:inline-block;vertical-align:middle;">
                    <img
                      src="{{ block.settings.icon | image_url: width: 120 }}"
                      alt=""
                      width="120"
                      height="71"
                      style="width:120px;height:70px;object-fit:contain;display:block;"
                    >
                  </span>
                {% endif %}
              {% endif %}
            </div>
          {% when 'cta' %}
            {% if block.settings.label and block.settings.url %}
              <a
                href="{{ block.settings.url }}"
                class="hero-cta-btn hero-cta-btn--{{ block.settings.style | default: 'primary' }}"
                style="color:{{ block.settings.color }};background:{{ block.settings.background_color }};padding:0.75em 2em;display:inline-block;text-decoration:none;font-weight:600;margin-top:1.5rem;"
              >
                {{ block.settings.label }}
              </a>
            {% endif %}
          {% when 'countdown' %}
            <div
              class="hero-countdown"
              style="display:inline-block;padding:0.5em 1em;background:{{ block.settings.background_color }};color:{{ block.settings.color }};border-radius:4px;font-weight:600;margin-top:1em;"
            >
              <span data-end-time="{{ block.settings.end_time }}">
                <!-- Countdown timer will be rendered here -->
                {{ block.settings.end_time }}
              </span>
            </div>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</div>

{%- style -%}
  #Banner-{{ section.id }}::after {
    {%- if section.settings.overlay_color != blank and section.settings.overlay_opacity > 0 -%}
      background: {{ section.settings.overlay_color }};
      opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    {%- else -%}
      background: none;
      opacity: 0;
    {%- endif -%}
  }

  #Banner-{{ section.id }} .hero-content {
    max-width: {% if section.settings.max_width %}800px{% else %}100%{% endif %};
    {%- if section.settings.show_content_background -%}
      background: rgba(255, 255, 255, 0.8);
    {%- endif -%}
  }

  @media (max-width: 749px) {
    #Banner-{{ section.id }} {
      height: {{ section.settings.height_mobile }}px !important;
    }
  }
{%- endstyle -%}

{% schema %}
{
  "name": "Jewlr Hero Banner",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "show_content_background",
      "label": "Show content background",
      "default": true
    },
    {
      "type": "select",
      "id": "background_type",
      "label": "Background type",
      "options": [
        { "value": "image", "label": "Image" },
        { "value": "video", "label": "Video" },
        { "value": "gradient", "label": "Gradient" }
      ],
      "default": "image"
    },
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image (desktop)"
    },
    {
      "type": "image_picker",
      "id": "background_image_mobile",
      "label": "Background image (mobile)"
    },
    {
      "type": "header",
      "content": "Video Settings"
    },
    {
      "type": "url",
      "id": "background_video",
      "label": "Background video URL",
      "info": "Only used if Background type is set to Video"
    },
    {
      "type": "header",
      "content": "Gradient Settings"
    },
    {
      "type": "color",
      "id": "background_gradient",
      "label": "Background gradient color",
      "info": "Only used if Background type is set to Gradient"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay opacity (%)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40
    },
    {
      "type": "range",
      "id": "height_desktop",
      "label": "Desktop height (px)",
      "min": 450,
      "max": 850,
      "step": 10,
      "default": 650
    },
    {
      "type": "range",
      "id": "height_mobile",
      "label": "Mobile height (px)",
      "min": 350,
      "max": 850,
      "step": 10,
      "default": 550
    },
    {
      "type": "checkbox",
      "id": "parallax",
      "label": "Enable parallax effect",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "settings": [
        { "type": "text", "id": "text", "label": "Heading text" },
        {
          "type": "checkbox",
          "id": "show_on_mobile",
          "label": "Show on mobile",
          "default": true
        },
        {
          "type": "select",
          "id": "tag",
          "label": "HTML tag",
          "options": [
            { "value": "h1", "label": "H1" },
            { "value": "h2", "label": "H2" },
            { "value": "h3", "label": "H3" }
          ],
          "default": "h1"
        },
        {
          "type": "range",
          "id": "font_size",
          "label": "Font size (desktop)",
          "min": 16,
          "max": 80,
          "step": 2,
          "default": 48
        },
        {
          "type": "range",
          "id": "font_size_mobile",
          "label": "Font size (mobile)",
          "min": 12,
          "max": 60,
          "step": 2,
          "default": 32
        },
        {
          "type": "select",
          "id": "font_weight",
          "label": "Font weight",
          "options": [
            { "value": "400", "label": "Normal" },
            { "value": "600", "label": "Semi-bold" },
            { "value": "700", "label": "Bold" }
          ],
          "default": "700"
        },
        { "type": "color", "id": "color", "label": "Text color" },
        {
          "type": "range",
          "id": "margin_bottom",
          "label": "Bottom margin (desktop)",
          "min": 0,
          "max": 60,
          "step": 2,
          "default": 16
        },
        {
          "type": "range",
          "id": "margin_bottom_mobile",
          "label": "Bottom margin (mobile)",
          "min": 0,
          "max": 60,
          "step": 2,
          "default": 12
        }
      ]
    },
    {
      "type": "subheading",
      "name": "Subheading",
      "settings": [
        { "type": "text", "id": "text", "label": "Subheading text" },
        {
          "type": "checkbox",
          "id": "show_on_mobile",
          "label": "Show on mobile",
          "default": true
        },
        {
          "type": "range",
          "id": "font_size",
          "label": "Font size (desktop)",
          "min": 16,
          "max": 48,
          "step": 2,
          "default": 24
        },
        {
          "type": "range",
          "id": "font_size_mobile",
          "label": "Font size (mobile)",
          "min": 12,
          "max": 40,
          "step": 2,
          "default": 18
        },
        {
          "type": "select",
          "id": "font_weight",
          "label": "Font weight",
          "options": [
            { "value": "400", "label": "Normal" },
            { "value": "600", "label": "Semi-bold" },
            { "value": "700", "label": "Bold" }
          ],
          "default": "400"
        },
        { "type": "color", "id": "color", "label": "Text color" },
        {
          "type": "range",
          "id": "margin_bottom",
          "label": "Bottom margin (desktop)",
          "min": 0,
          "max": 60,
          "step": 2,
          "default": 16
        },
        {
          "type": "range",
          "id": "margin_bottom_mobile",
          "label": "Bottom margin (mobile)",
          "min": 0,
          "max": 60,
          "step": 2,
          "default": 12
        },
        { "type": "image_picker", "id": "icon", "label": "Decorative icon/image (optional)" },
        {
          "type": "select",
          "id": "icon_placement",
          "label": "Icon placement",
          "options": [
            { "value": "left", "label": "Left of text" },
            { "value": "right", "label": "Right of text" }
          ],
          "default": "left"
        },
        {
          "type": "range",
          "id": "icon_gap",
          "label": "Gap to text (px)",
          "min": 0,
          "max": 40,
          "step": 2,
          "default": 8
        }
      ]
    },
    {
      "type": "badge",
      "name": "Badge/Tagline",
      "settings": [
        { "type": "text", "id": "text", "label": "Badge text" },
        { "type": "color", "id": "color", "label": "Badge color" },
        { "type": "color", "id": "background_color", "label": "Background color" }
      ]
    },
    {
      "type": "cta",
      "name": "CTA Button",
      "settings": [
        { "type": "text", "id": "label", "label": "Button label" },
        { "type": "url", "id": "url", "label": "Button link" },
        {
          "type": "select",
          "id": "style",
          "label": "Button style",
          "options": [
            { "value": "primary", "label": "Primary" },
            { "value": "secondary", "label": "Secondary" },
            { "value": "outline", "label": "Outline" }
          ],
          "default": "primary"
        },
        { "type": "color", "id": "color", "label": "Button color" },
        { "type": "color", "id": "background_color", "label": "Button background color" }
      ]
    },
    {
      "type": "countdown",
      "name": "Countdown Timer",
      "settings": [
        { "type": "text", "id": "end_time", "label": "End date/time (YYYY-MM-DD HH:MM)" },
        { "type": "color", "id": "color", "label": "Text color" },
        { "type": "color", "id": "background_color", "label": "Background color" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Jewlr Hero Banner",
      "category": "Hero banners",
      "blocks": [{ "type": "heading" }, { "type": "subheading" }, { "type": "cta" }]
    }
  ]
}
{% endschema %}
